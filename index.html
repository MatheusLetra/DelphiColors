<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Conversor Delphi ($00BBGGRR) → Hex/RGB</title>
  <style>
    :root{
      --bg:#0b0f14;--panel:#121821;--muted:#94a3b8;--text:#e5e7eb;--accent:#60a5fa;--ok:#22c55e;--err:#ef4444;
      --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 800px at 10% 0%, #0f172a 0, transparent 60%),
                  radial-gradient(1200px 800px at 110% 20%, #0b1220 0, transparent 60%),
                  var(--bg);
      color:var(--text);
      display:grid; place-items:center; padding:24px;
    }
    .card{
      width:min(900px, 100%);
      background:linear-gradient(180deg,#0f172a, #0b1220);
      border:1px solid #1f2937; border-radius:var(--radius); padding:24px; 
      box-shadow:0 20px 60px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.03);
    }
    h1{font-size:clamp(20px,2.4vw,28px); margin:0 0 4px; font-weight:700; letter-spacing:.2px}
    p.sub{margin:0 0 18px; color:var(--muted); font-size:14px}

    .grid{display:grid; grid-template-columns: 1.1fr .9fr; gap:18px}
    @media (max-width: 760px){ .grid{grid-template-columns:1fr} }

    .section{background:var(--panel); border:1px solid #1f2937; border-radius:var(--radius); padding:18px}
    .section h2{margin:0 0 12px; font-size:16px; color:#cbd5e1}

    label{font-size:12px; color:#cbd5e1; display:block; margin:10px 0 6px}
    .row{display:flex; gap:10px; align-items:center}

    input[type="text"], .out{
      width:100%; padding:12px 14px; border-radius:12px; border:1px solid #334155; background:#0b1220; color:var(--text);
      outline:none; font-size:14px; letter-spacing:.3px;
    }
    input[type="text"]:focus{border-color:#3b82f6; box-shadow:0 0 0 3px rgba(59,130,246,.15)}
    .hint{font-size:12px; color:var(--muted); margin-top:6px}

    .btn{
      padding:12px 14px; border-radius:12px; border:1px solid #334155; background:#0b1220; color:var(--text);
      cursor:pointer; transition:transform .05s ease, border-color .2s ease; user-select:none;
    }
    .btn:hover{border-color:#3b82f6}
    .btn:active{transform:translateY(1px)}

    .copy{display:inline-flex; align-items:center; gap:8px}
    .mini{font-size:12px; padding:8px 10px}

    .preview{
      aspect-ratio: 1.7/1; border-radius:14px; border:1px solid #334155; background:#111827; position:relative; overflow:hidden;
    }
    .preview .swatch{position:absolute; inset:0}
    .preview .checker{position:absolute; inset:0; background:
      conic-gradient(#0000 90deg,#0003 0 180deg,#0000 0 270deg,#0003 0) 0 0/24px 24px,
      conic-gradient(#fff3 90deg,#fff0 0 180deg,#fff3 0 270deg,#fff0 0) 12px 12px/24px 24px}

    .columns{display:grid; grid-template-columns: repeat(3, 1fr); gap:10px}
    @media (max-width: 560px){ .columns{grid-template-columns:1fr} }

    .pill{display:flex; align-items:center; justify-content:space-between; gap:12px}
    .status{font-size:12px; margin-top:10px}
    .ok{color:var(--ok)} .err{color:var(--err)}
    .foot{margin-top:18px; color:var(--muted); font-size:12px}
    code{background:#0b1220; border:1px solid #334155; padding:2px 6px; border-radius:8px}
  </style>
</head>
<body>
  <main class="card">
    <h1>Conversor de cor Delphi <span style="opacity:.8">($00BBGGRR)</span></h1>
    <p class="sub">Cole o valor no formato <code>$00FFE7B3</code> e obtenha <strong>HEX</strong> e <strong>RGB</strong>. Pré‑visualização inclusa.</p>

    <section class="grid">
      <!-- Entrada e resultados -->
      <div class="section">
        <h2>Entrada</h2>
        <label for="delphi">Cor Delphi ($00BBGGRR)</label>
        <div class="row">
          <input id="delphi" type="text" placeholder="$00FFE7B3" inputmode="latin" autocomplete="off" spellcheck="false" aria-label="Valor de cor Delphi" />
          <button id="btnConvert" class="btn">Converter</button>
        </div>
        <div id="hint" class="hint">Formato esperado: <code>$00BBGGRR</code> (BGR little‑endian do Delphi/VCL).</div>
        <div id="status" class="status"></div>

        <h2 style="margin-top:16px">Resultados</h2>
        <div class="columns">
          <div>
            <label for="hex">HEX (#RRGGBB)</label>
            <div class="row pill">
              <input id="hex" class="out" type="text" readonly>
              <button data-copy="#hex" class="btn mini copy">Copiar</button>
            </div>
          </div>
          <div>
            <label for="rgb">RGB (r, g, b)</label>
            <div class="row pill">
              <input id="rgb" class="out" type="text" readonly>
              <button data-copy="#rgb" class="btn mini copy">Copiar</button>
            </div>
          </div>
          <div>
            <label for="bgr">Bytes (B,G,R)</label>
            <div class="row pill">
              <input id="bgr" class="out" type="text" readonly>
              <button data-copy="#bgr" class="btn mini copy">Copiar</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Pré-visualização -->
      <div class="section">
        <h2>Pré‑visualização</h2>
        <div class="preview">
          <div class="checker"></div>
          <div id="swatch" class="swatch"></div>
        </div>
        <div class="foot">Dica: duplo‑clique nos campos de saída para copiar. Valores inválidos mostrarão uma borda vermelha.</div>
      </div>
    </section>

    <p class="foot">Notas: No Delphi (VCL), <code>TColor</code> usa <code>$00BBGGRR</code>. Ou seja, o byte menos significativo é o <strong>R</strong> (vermelho). Ex.: <code>$00FFE7B3</code> → bytes <em>BB, GG, RR</em> = FF, E7, B3 ⇒ RGB = (179, 231, 255) ⇒ HEX = #B3E7FF.</p>
  </main>

  <script>
    // Utilidades
    const $ = (q, c = document) => c.querySelector(q);
    const $$ = (q, c = document) => [...c.querySelectorAll(q)];

    function normalizeInput(str){
      if(!str) return '';
      str = String(str).trim().toUpperCase();
      // Aceita com ou sem '$' / '0x'
      if(str.startsWith('$')) str = str.slice(1);
      if(str.startsWith('0X')) str = str.slice(2);
      // Remove underscores/espacos
      str = str.replace(/[_\s]/g, '');
      return str;
    }

    function isValidDelphiHex(h){
      // Precisamos de 8 hex (00BBGGRR). Muitos códigos Delphi têm os 2 primeiros bytes 00.
      return /^[0-9A-F]{8}$/.test(h);
    }

    function delphiToRgb(hex8){
      // hex8 = 8 dígitos: 00BBGGRR (little-endian BGR)
      const rr = parseInt(hex8.slice(6,8), 16);
      const gg = parseInt(hex8.slice(4,6), 16);
      const bb = parseInt(hex8.slice(2,4), 16);
      return { r: rr, g: gg, b: bb };
    }

    function toHex({r,g,b}){
      const h = (n)=> n.toString(16).padStart(2,'0').toUpperCase();
      return `#${h(r)}${h(g)}${h(b)}`;
    }

    function updatePreview(color){
      $('#swatch').style.background = color || 'transparent';
      const sw = $('.preview');
      if(color){ sw.style.borderColor = '#334155'; }
      else { sw.style.borderColor = '#7f1d1d'; }
    }

    function setStatus(msg, ok=true){
      const el = $('#status');
      el.textContent = msg || '';
      el.className = `status ${ok ? 'ok' : 'err'}`;
    }

    function copyFrom(selector){
      const el = $(selector);
      if(!el || !el.value) return;
      el.select();
      document.execCommand('copy');
      const btn = document.activeElement;
      if(btn && btn.classList.contains('copy')){
        const orig = btn.textContent;
        btn.textContent = 'Copiado!';
        setTimeout(()=> btn.textContent = orig, 900);
      }
    }

    function renderOutputs(rgb){
      if(!rgb){
        ['#hex','#rgb','#bgr'].forEach(id=> $(id).value = '');
        updatePreview('');
        return;
      }
      const hex = toHex(rgb);
      $('#hex').value = hex;
      $('#rgb').value = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
      $('#bgr').value = `B=${rgb.b}  G=${rgb.g}  R=${rgb.r}`;
      updatePreview(hex);
    }

    function convert(){
      const raw = $('#delphi').value;
      const norm = normalizeInput(raw);
      if(!isValidDelphiHex(norm)){
        renderOutputs(null);
        setStatus('Valor inválido. Use 8 dígitos hexadecimais como $00FFE7B3.', false);
        $('#delphi').style.borderColor = '#ef4444';
        return;
      }
      $('#delphi').style.borderColor = '#334155';
      const rgb = delphiToRgb(norm);
      renderOutputs(rgb);
      setStatus('Conversão realizada com sucesso.');
    }

    // Eventos
    $('#btnConvert').addEventListener('click', convert);
    $('#delphi').addEventListener('input', () => {
      const v = normalizeInput($('#delphi').value);
      if(v.length === 8 && isValidDelphiHex(v)){
        const rgb = delphiToRgb(v);
        renderOutputs(rgb);
        setStatus('OK');
      } else {
        renderOutputs(null);
        setStatus('', true);
      }
    });

    $$('.copy').forEach(btn=> btn.addEventListener('click', e => copyFrom(btn.dataset.copy)));
    $$('#hex, #rgb, #bgr').forEach(out=> out.addEventListener('dblclick', e => copyFrom(`#${out.id}`)));

    // Exemplo inicial
    $('#delphi').value = '$00FFE7B3';
    convert();
  </script>
</body>
</html>
